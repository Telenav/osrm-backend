# OSRM Traffic Updater
The **OSRM Traffic Updater** is designed for pull traffic data from **Traffic Proxy(Telenav)** then dump to OSRM required `traffic.csv`. Refer to [OSRM with Telenav Traffic Design](../docs/design/osrm-with-telenav-traffic.md) and [OSRM Traffic](https://github.com/Project-OSRM/osrm-backend/wiki/Traffic) for more details.        

## RPC Protocol
See [proxy.proto](proxy.proto) for details.    

## Requirements
- `go1.13`

## Usage

### osrm-traffic-updater
```bash
$ cd github.com/Telenav/osrm-backend/traffic_updater
$ go install ./...
$ ${GOPATH}/bin/osrm-traffic-updater -h
Usage of /Users/jiezhang2/workspace/go/bin/osrm-traffic-updater:
  -c string
    	target traffic proxy ip address (default "127.0.0.1")
  -f string
    	OSRM traffic csv file (default "traffic.csv")
  -m string
    	OSRM way id to node ids mapping table (default "wayid2nodeids.csv")
  -map string
    	map data provider
  -p int
    	target traffic proxy port (default 10086)
  -region string
    	region (default "na")
  -traffic string
    	traffic data provider
```

### wayid2nodeids_extractor
Extract wayid to nodeids mapping from PBF.

```bash
$ cd github.com/Telenav/osrm-backend/traffic_updater
$ go install ./...
$ ${GOPATH}/bin/wayid2nodeid-extractor -h
Usage of /Users/jiezhang2/workspace/go/bin/wayid2nodeid-extractor:
  -b	Is pbf generated by telenav internally
  -i string
    	Input pbf file.
  -o string
    	Output csv file
```

### snappy

```bash
$ cd github.com/Telenav/osrm-backend/traffic_updater
$ go install ./...
$ ${GOPATH}/bin/snappy -h
Usage of /Users/jiezhang2/workspace/go/bin/snappy:
  -i string
    	Input file.
  -o string
    	Output file.

```
